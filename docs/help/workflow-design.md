---
summary: "Planモード中心の実行規律、タスク管理、自己改善の運用ルール"
read_when:
  - 実装を始める前に進め方を確認したいとき
  - サブエージェント運用と検証方針を統一したいとき
title: "Workflow Design"
---

# Workflow Design

このページは、実装に入る前の進め方と完了判定の基準を定義する。

Page type: how-to

## Scope

- 対象: Planモード運用、サブエージェント戦略、タスク管理、自己改善
- 非対象: 個別機能の仕様や実装詳細

## Workflow Design

### 1. Planモードを基本とする

- 3ステップ以上、またはアーキテクチャに関わるタスクは Plan モードで開始する。
- 途中で行き詰まったら、無理に進めず立ち止まって再計画する。
- 実装だけでなく検証ステップにも Plan モードを使う。
- 実装前に仕様を明文化し、曖昧さを減らす。

### 2. サブエージェント戦略

- メインコンテキストをクリーンに保つため、サブエージェントを積極活用する。
- リサーチ・調査・並列分析はサブエージェントに委譲する。
- 複雑な課題はサブエージェントを使って計算リソースを増やす。
- 1サブエージェントにつき1タスクを割り当てる。

### 3. 自己改善ループ

- ユーザーから修正を受けたら、再発防止パターンを `tasks/lessons.md` に記録する。
- 同じミスを繰り返さないよう、行動ルールとして明文化する。
- ミス率が下がるまでルールを継続的に改善する。
- セッション開始時に、そのプロジェクトに関係する lessons を確認する。

### 4. 完了前に必ず検証する

- 動作を証明できるまでタスクを完了扱いにしない。
- 必要に応じて `main` と変更差分を確認する。
- 「スタッフエンジニアが承認できるか」を基準に自己レビューする。
- テスト実行とログ確認で正しさを示す。

### 5. エレガントさを追求する（バランス重視）

- 重要変更の前に「よりエレガントな方法がないか」を一度検討する。
- ハック的修正と判断した場合は、前提を更新してより良い解決策を選び直す。
- シンプルで明白な修正では過剰設計を避ける。
- 提示前に自己レビューし、説明責任を持てる状態にする。

### 6. 自律的なバグ修正

- バグ報告を受けたら、追加指示を待たずに原因調査と修正を進める。
- ログ・エラー・失敗テストを起点に自律的に解決する。
- ユーザーのコンテキスト切り替えコストを最小化する。
- 指示がなくても、失敗している CI テストの修正候補を確認する。

## Task Management

1. まず `tasks/todo.md` にチェック可能な計画を書く。
2. 実装前に計画内容を確認する。
3. 進捗に応じて完了項目を随時更新する。
4. 各ステップで高レベルの変更サマリーを残す。
5. 完了時に `tasks/todo.md` に review セクションを追記する。
6. 修正を受けた後は `tasks/lessons.md` を更新する。

## Core Principles

- **シンプル第一**: 変更はできる限り単純にし、影響範囲を最小化する。
- **手を抜かない**: 根本原因を特定し、一時しのぎを避ける。
- **影響を最小化する**: 必要箇所だけを変更し、新規不具合を持ち込まない。

## Related

- [Issue, Plan, PR Flow](/help/issue-plan-pr)
- [Agent Workflow](/help/agent-workflow)
- [Testing](/help/testing)
